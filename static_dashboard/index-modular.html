<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="FCA Analysis Dashboard - Advanced fraud detection, sentiment analysis, and customer attrition prediction dashboard">
    <meta name="keywords" content="fraud detection, sentiment analysis, customer attrition, machine learning, dashboard">
    <meta name="author" content="FCA Team">
    <meta name="theme-color" content="#4e73df">
    
    <title>FCA Analysis Dashboard</title>
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="./assets/css/dashboard-modular.css" as="style">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" as="style">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style">
    
    <!-- CSS Dependencies -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="./assets/css/dashboard-modular.css" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="./assets/images/favicon.ico">
    
    <!-- Preconnect to External Resources -->
    <link rel="preconnect" href="https://cdn.plot.ly">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-indicator" class="loading-overlay visible">
        <div class="loading-content">
            <div class="spinner-border text-primary mb-3" role="status" style="width: 3rem; height: 3rem;">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div class="loading-message h5 text-muted">Loading FCA Dashboard...</div>
            <div class="loading-submessage small text-muted mt-2">Initializing modules and loading data</div>
        </div>
    </div>

    <!-- Main Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
        <div class="container-fluid">
            <!-- Brand -->
            <a class="navbar-brand d-flex align-items-center" href="#dashboard">
                <i class="fas fa-chart-line me-2"></i>
                <span>FCA Dashboard</span>
            </a>

            <!-- Mobile Toggle -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Navigation Links -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#dashboard" data-page="dashboard">
                            <i class="fas fa-tachometer-alt me-1"></i>
                            <span>Overview</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#fraud" data-page="fraud">
                            <i class="fas fa-shield-alt me-1"></i>
                            <span>Fraud Detection</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#sentiment" data-page="sentiment">
                            <i class="fas fa-comments me-1"></i>
                            <span>Sentiment Analysis</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#attrition" data-page="attrition">
                            <i class="fas fa-users me-1"></i>
                            <span>Customer Attrition</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#datasets" data-page="datasets">
                            <i class="fas fa-database me-1"></i>
                            <span>Datasets</span>
                        </a>
                    </li>
                </ul>

                <!-- Settings Dropdown -->
                <div class="navbar-nav">
                    <div class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-cog me-1"></i>
                            <span>Settings</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li>
                                <a class="dropdown-item" href="#" data-action="toggle-theme">
                                    <i class="fas fa-moon me-2"></i>
                                    <span class="theme-text">Dark Mode</span>
                                </a>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <a class="dropdown-item" href="#" id="refresh-data">
                                    <i class="fas fa-sync-alt me-2"></i>
                                    <span>Refresh Data</span>
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item" href="#" data-action="download-data">
                                    <i class="fas fa-download me-2"></i>
                                    <span>Download Data</span>
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item" href="#" data-action="clear-cache">
                                    <i class="fas fa-trash me-2"></i>
                                    <span>Clear Cache</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Page Header -->
        <div class="page-header">
            <div class="container-fluid">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h1 class="page-title" id="page-title-text">Overview</h1>
                        <p class="page-subtitle">Financial Crime Analysis Dashboard</p>
                    </div>
                    <div class="page-actions">
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-outline-primary btn-sm" data-action="refresh-page">
                                <i class="fas fa-redo me-1"></i>
                                Refresh
                            </button>
                            <button type="button" class="btn btn-outline-secondary btn-sm" data-action="export-page">
                                <i class="fas fa-file-export me-1"></i>
                                Export
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard Content -->
        <div class="content-wrapper" id="dashboard-content" style="display: none;">
            
            <!-- Dashboard Overview Page -->
            <div id="dashboard-page" class="page-section active">
                <!-- Summary Cards -->
                <div class="summary-grid mb-4">
                    <div class="summary-card">
                        <div class="summary-card-icon text-primary">
                            <i class="fas fa-database"></i>
                        </div>
                        <div class="summary-card-value" id="total-datasets">Loading...</div>
                        <div class="summary-card-label">Total Datasets</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-card-icon text-success">
                            <i class="fas fa-brain"></i>
                        </div>
                        <div class="summary-card-value" id="models-trained">Loading...</div>
                        <div class="summary-card-label">Models Trained</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-card-icon text-info">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="summary-card-value" id="fraud-detection-rate">Loading...</div>
                        <div class="summary-card-label">Detection Rate</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-card-icon text-warning">
                            <i class="fas fa-heartbeat"></i>
                        </div>
                        <div class="summary-card-value" id="system-status">Loading...</div>
                        <div class="summary-card-label">System Status</div>
                    </div>
                </div>

                <!-- Overview Charts -->
                <div class="chart-grid">
                    <div class="chart-container">
                        <h5 class="chart-title">Model Performance Comparison</h5>
                        <div id="model-performance-chart"></div>
                    </div>
                    <div class="chart-container">
                        <h5 class="chart-title">Fraud Risk Distribution</h5>
                        <div id="fraud-risk-chart"></div>
                    </div>
                    <div class="chart-container">
                        <h5 class="chart-title">Sentiment Analysis Overview</h5>
                        <div id="sentiment-distribution-chart"></div>
                    </div>
                    <div class="chart-container">
                        <h5 class="chart-title">Customer Segmentation</h5>
                        <div id="customer-segments-chart"></div>
                    </div>
                </div>
            </div>

            <!-- Fraud Detection Page -->
            <div id="fraud-page" class="page-section">
                <div class="chart-grid">
                    <div class="chart-container">
                        <h5 class="chart-title">ROC Curve Analysis</h5>
                        <div id="roc-curve-chart"></div>
                    </div>
                    <div class="chart-container">
                        <h5 class="chart-title">Feature Importance</h5>
                        <div id="feature-importance-chart"></div>
                    </div>
                    <div class="chart-container">
                        <h5 class="chart-title">Confusion Matrix</h5>
                        <div id="confusion-matrix-chart"></div>
                    </div>
                    <div class="chart-container">
                        <h5 class="chart-title">Precision-Recall Curve</h5>
                        <div id="precision-recall-chart"></div>
                    </div>
                </div>
            </div>

            <!-- Sentiment Analysis Page -->
            <div id="sentiment-page" class="page-section">
                <div class="chart-grid">
                    <div class="chart-container">
                        <h5 class="chart-title">Sentiment Trends Over Time</h5>
                        <div id="sentiment-trends-chart"></div>
                    </div>
                    <div class="chart-container">
                        <h5 class="chart-title">Confidence Score Distribution</h5>
                        <div id="confidence-distribution-chart"></div>
                    </div>
                    <div class="chart-container">
                        <h5 class="chart-title">Word Cloud Analysis</h5>
                        <div id="wordcloud-chart"></div>
                    </div>
                    <div class="chart-container">
                        <h5 class="chart-title">Topic Modeling Results</h5>
                        <div id="topic-modeling-chart"></div>
                    </div>
                </div>
            </div>

            <!-- Customer Attrition Page -->
            <div id="attrition-page" class="page-section">
                <div class="chart-grid">
                    <div class="chart-container">
                        <h5 class="chart-title">Churn Prediction Performance</h5>
                        <div id="churn-performance-chart"></div>
                    </div>
                    <div class="chart-container">
                        <h5 class="chart-title">Customer Lifetime Value</h5>
                        <div id="clv-analysis-chart"></div>
                    </div>
                    <div class="chart-container">
                        <h5 class="chart-title">Retention Strategies ROI</h5>
                        <div id="retention-roi-chart"></div>
                    </div>
                    <div class="chart-container">
                        <h5 class="chart-title">Risk Factor Analysis</h5>
                        <div id="risk-factors-chart"></div>
                    </div>
                </div>
            </div>

            <!-- Datasets Page -->
            <div id="datasets-page" class="page-section">
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">Available Datasets</h5>
                            </div>
                            <div class="card-body">
                                <div class="row" id="datasets-list">
                                    <!-- Dataset cards will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Error Display Area -->
        <div id="error-display" class="container-fluid"></div>
    </div>

    <!-- JavaScript Dependencies -->
    <script src="https://cdn.plot.ly/plotly-2.25.2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Application Entry Point -->
    <script type="module" src="./assets/js/app.js"></script>

    <!-- Service Worker Registration (Progressive Web App) -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('./sw.js')
                    .then(function(registration) {
                        console.log('SW registered: ', registration);
                    }, function(registrationError) {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>

    <!-- Performance Monitoring -->
    <script>
        // Basic performance monitoring
        window.addEventListener('load', function() {
            setTimeout(function() {
                const perfData = performance.getEntriesByType('navigation')[0];
                console.log('Page Load Performance:', {
                    domContentLoaded: perfData.domContentLoadedEventEnd - perfData.domContentLoadedEventStart,
                    totalLoad: perfData.loadEventEnd - perfData.loadEventStart,
                    firstPaint: performance.getEntriesByType('paint')[0]?.startTime
                });
            }, 0);
        });
    </script>
</body>
</html>